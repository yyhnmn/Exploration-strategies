import torch
import torch.nn as nn
import torch.nn.functional as f
from agents.NoisyLinear import NoisyLinear


class NoisyNet(nn.Module):
    def __init__(self, input_size, h1_size, h2_size, output_size):
        super().__init__()
        self.input_size = input_size
        self.h1_size = h1_size
        self.h2_size = h2_size
        self.output_size = output_size
        self.fc_1 = nn.Linear(self.input_size, self.h1_size, bias=True)
        self.fc_2 = NoisyLinear(self.h1_size, self.h2_size)
        self.fc_out = NoisyLinear(self.h2_size, self.output_size)


    def forward(self, x):
        x = x.float()
        x = f.relu(self.fc_1(x))
        features = f.relu(self.fc_2(x))

        # give back both the outputs of the Q network
        # and the "features" generated by the second to last layer
        return self.fc_out(features), features

    def cloneWeightsTo(self, toNet):
        toNet.load_state_dict(self.state_dict())

    def reset_noise(self):
        self.fc_2.reset_noise()
        self.fc_out.reset_noise()


